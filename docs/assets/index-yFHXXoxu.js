import{p as s,P as t}from"./phaser-DqFVsdsa.js";!function(){const s=document.createElement("link").relList;if(!(s&&s.supports&&s.supports("modulepreload"))){for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver((s=>{for(const e of s)if("childList"===e.type)for(const s of e.addedNodes)"LINK"===s.tagName&&"modulepreload"===s.rel&&t(s)})).observe(document,{childList:!0,subtree:!0})}function t(s){if(s.ep)return;s.ep=!0;const t=function(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),"use-credentials"===s.crossOrigin?t.credentials="include":"anonymous"===s.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(s);fetch(s.href,t)}}();class e extends s.Scene{constructor(){super("scene-boot")}preload(){this.load.image("bottom","assets/bottom_bg.png"),this.load.image("buttons","assets/buttons.png"),this.load.image("up","assets/up.png"),this.load.image("down","assets/down.png"),this.load.image("left","assets/left.png"),this.load.image("right","assets/right.png"),this.load.image("start","assets/start.png"),this.load.image("jump","assets/jump.png"),this.load.image("top","assets/top_bg.png"),this.load.image("img","assets/spritesheet.png"),this.load.spritesheet("hero","assets/spritesheet.png",{frameWidth:315,frameHeight:406}),this.load.spritesheet("others","assets/spritesheet_others.png",{frameWidth:315,frameHeight:406}),this.load.audio("takeKey",["assets/sounds/takeKey.ogg"]),this.load.audio("takeSword",["assets/sounds/takeSword.ogg"]),this.load.audio("death",["assets/sounds/dead.ogg"]),this.load.audio("keyPress",["assets/sounds/keyPress.ogg"]),this.load.css("headers","main.css")}create(){this.registry.set("ownObjects",[]),this.scene.start("scene-game")}}class i extends s.Scene{update(s,t){}_checkTarget(){}base_create(){console.log("registry",this.registry.get("ownObjects"))}}const o={right:"right",left:"left",up:"up",down:"down",jump:"jump",takeKey:Symbol(),takeSword:Symbol(),death:Symbol(),deathEnd:Symbol(),noLives:Symbol(),friendPlatform:Symbol(),friendPlatformLeave:Symbol(),floor3:Symbol(),floor2:Symbol(),floor1:Symbol(),swordHit:Symbol(),heroHitByMonkey:Symbol(),heroHitByMonkeyOnMiddleOrRight:Symbol(),openLock:Symbol(),openLockFinished:Symbol(),princessFree:Symbol(),none:!1};class r{hideShow(s){this._allPositions.forEach((t=>{this._positions[t].sprite.setVisible(s)})),this._allSwordPositions.forEach((t=>{this._swordPositions[t].sprite.setVisible(s)}))}start(){this.hideShow(!1),this._dead=!1,this._wasUnlocked=!1,this._position="pos1",this._lives=3,this._keyIsTaken=!1,this._swordIsTaken=!1,this._positions.pos1.sprite.setVisible(!0),this._faces.face1.sprite.setVisible(!1),this._faces.face2.sprite.setVisible(!1),this._faces.face3.sprite.setVisible(!1),console.log("Detecting hero     ....  [PRINCE]")}reset(){this.hideShow(!0),this._dead=!1,this._faces.face1.sprite.setVisible(!0),this._faces.face2.sprite.setVisible(!0),this._faces.face3.sprite.setVisible(!0)}death(s){this._dead=!0,this._flashCountsDead=14,this._lives--}tryAgain(s,t){return!(!this._dead&&!t)&&(console.warn("Try again!"),2===this._lives?this._faces.face1.sprite.setVisible(!0):1===this._lives?this._faces.face2.sprite.setVisible(!0):0===this._lives&&this._faces.face3.sprite.setVisible(!0),0!==this._lives?(this.hideShow(!1),this._dead=!1,this._position="pos1",this._keyIsTaken=!1,this._swordIsTaken=!1,this._positions.pos1.sprite.setVisible(!0),!0):void s.emit(o.noLives))}create(s){this._autoAction=void 0,this._swordIsTaken=!1,this._keyIsTaken=!1,this._dead=!1,this._flashCountsDead=0,this._pause=!1,this._openCounts=0,this._position="pos1",this._currentSword="",this._timeAutoAction=0,this._lives=3,this._faces={face1:s.addOthers({x:140,y:60,frame:36,visible:!0},{}),face2:s.addOthers({x:180,y:60,frame:36,visible:!0},{}),face3:s.addOthers({x:220,y:60,frame:36,visible:!0},{}),gameA:s.addOthers({x:60,y:80,frame:44,scale:.4,visible:!0},{})},this._swordPositions={pos17:s.addOthers({x:483,y:298,frame:23},{left:"pos19",jump:"pos18"}),pos18:s.addOthers({x:465,y:210,frame:23},{noAction:"pos17",left:"pos19"}),pos19:s.addOthers({x:392,y:296,frame:23},{left:"pos21",jump:"pos20"}),pos20:s.addOthers({x:355,y:232,frame:24},{noAction:"pos19",left:"pos20"}),pos21:s.addOthers({x:385,y:284,frame:25},{left:"pos22"}),pos22:s.addOthers({x:248,y:286,frame:28},{left:"pos23"}),pos23:s.addOthers({x:78,y:265,frame:26},{up:"pos24"}),pos24:s.addOthers({x:80,y:130,frame:27},{right:"pos25",down:"pos23",jump:"pos24_2"}),pos24_2:s.addOthers({x:95,y:170,frame:28},{right:"pos25",down:"pos23",jump:"pos24"}),pos25:s.addOthers({x:220,y:115,frame:30},{right:"pos26",left:"pos24",jump:"pos25_2"}),pos25_2:s.addOthers({x:243,y:159,frame:29},{right:"pos26",left:"pos24",jump:"pos25"}),pos26:s.addOthers({x:380,y:78,frame:32},{right:"pos27",left:"pos25",jump:"pos26_2"}),pos26_2:s.addOthers({x:400,y:120,frame:31},{right:"pos27",left:"pos25",jump:"pos26"})},this._positions={pos1:s.addHeroTo({x:60,y:620,frame:0},{right:"pos2"}),pos2:s.addHeroTo({x:120,y:620,frame:1},{jump:"pos3",left:"pos1",right:"take:key"}),pos3:s.addHeroTo({x:80,y:490,frame:2},{right:"pos4",noAction:"pos2"}),pos4:s.addHeroTo({x:130,y:490,frame:3},{jump:"pos5",left:"pos3"}),pos5:s.addHeroTo({x:110,y:410,frame:4},{right:"pos6",noAction:"pos4"}),pos5_1:s.addHeroTo({x:110,y:410,frame:4},{right:"pos6",noAction:"pos4"}),pos6:s.addHeroTo({x:210,y:450,frame:5},{jump:"pos8",left:"pos5_1"}),pos7:s.addHeroTo({x:275,y:590,frame:6},{death:!0}),pos8:s.addHeroTo({x:265,y:350,frame:7},{right:"pos9",noAction:"pos9"}),pos8_1:s.addHeroTo({x:265,y:350,frame:7},{noAction:"pos6"}),pos9:s.addHeroTo({x:300,y:440,frame:8},{right:"pos10",left:"pos7",jump:"pos8_1"}),pos10:s.addHeroTo({x:360,y:435,frame:9},{right:"pos11",jump:"pos12",left:"pos9"}),pos11:s.addHeroTo({x:390,y:560,frame:10},{death:!0}),pos12:s.addHeroTo({x:430,y:370,frame:11},{noAction:"pos13"}),pos12_1:s.addHeroTo({x:430,y:370,frame:11},{noAction:"pos10"}),pos13:s.addHeroTo({x:430,y:460,frame:12},{noAction:"pos14"}),pos13_1:s.addHeroTo({x:430,y:460,frame:12},{noAction:"pos12_1"}),pos14:s.addHeroTo({x:470,y:520,frame:13},{noAction:"pos15"}),pos14_1:s.addHeroTo({x:470,y:520,frame:13},{noAction:"pos13_1"}),pos15:s.addHeroTo({x:490,y:430,frame:14},{noAction:"pos16"}),pos15_1:s.addHeroTo({x:490,y:430,frame:14},{noAction:"pos14_1"}),pos16:s.addHeroTo({x:510,y:360,frame:15},{noAction:"pos17",right:"take:sword"}),pos16_1:s.addHeroTo({x:510,y:360,frame:15},{noAction:"pos15_1"}),pos17:s.addHeroTo({x:510,y:260,frame:16},{left:"pos19",jump:"pos18",right:"pos16_1"}),pos18:s.addHeroTo({x:490,y:190,frame:17},{noAction:"pos17",left:"pos19"}),pos19:s.addHeroTo({x:420,y:260,frame:18},{left:"pos21",jump:"pos20",right:"pos17"}),pos20:s.addHeroTo({x:390,y:165,frame:19},{noAction:"pos19",left:"pos20"}),pos21:s.addHeroTo({x:320,y:260,frame:20},{left:"pos22",right:"pos19"}),pos22:s.addHeroTo({x:180,y:245,frame:21},{left:"pos23",right:"pos21"}),pos23:s.addHeroTo({x:90,y:245,frame:22},{up:"pos24",right:"pos22"}),pos24:s.addHeroTo({x:40,y:130,frame:23},{right:"cond:pos25",down:"pos23",jump:"fight:sword"}),pos25:s.addHeroTo({x:200,y:120,frame:24},{right:"cond:pos26",left:"pos24",jump:"fight:sword"}),pos26:s.addHeroTo({x:350,y:80,frame:25},{right:"cond:pos27",left:"pos25",jump:"fight:sword"}),pos27:s.addHeroTo({x:490,y:95,frame:26},{right:"take:openKey",left:"pos26"})},this._allPositions=Object.keys(this._positions),this._allSwordPositions=Object.keys(this._swordPositions)}_hasSwordInHands(){return"pos26"!==this._currentSword&&this._swordIsTaken}_hasKeyInHands(){return"pos26"===this._currentSword&&this._keyIsTaken}changeSwordPositionIfApplies(s,t,e){this._allSwordPositions.includes(this._currentSword)&&this._swordPositions[this._currentSword].sprite.setVisible(!1),this._allSwordPositions.includes(t)&&(this._hasSwordInHands()||this._hasKeyInHands())&&(this._currentSword=t,this._swordPositions[this._currentSword].sprite.setVisible(!0))}getPosition(){return this._position}swordFight(s,t,e){this._swordIsTaken&&(this._currentSword.includes(s)||(console.log("not includes currentPosition",this._currentSword,s),this._currentSword=s),("pos24"===s&&"left"===t||"pos25"===s&&"middle"===t||"pos26"===s&&"right"===t)&&e.emit(o.swordHit),this._swordPositions[this._currentSword].sprite.setVisible(!1),this._currentSword=this._swordPositions[this._currentSword].actions.jump,this._swordPositions[this._currentSword].sprite.setVisible(!0))}_changePosition(s,t){this._autoAction=void 0,"pos14"===s||"pos14_1"===s?t.emit(o.friendPlatform):"pos14"!==this._position&&"pos14_1"!==this._position||t.emit(o.friendPlatformLeave),"pos23"===this._position&&"pos24"===s?t.emit(o.floor3,o.up):"pos24"===this._position&&"pos23"===s?t.emit(o.floor2,o.down):"pos16"===this._position&&"pos17"===s?t.emit(o.floor2,o.up):"pos17"===this._position&&"pos16_1"===s&&(this._swordIsTaken=!1,t.emit(o.floor1,o.down)),this.changeSwordPositionIfApplies(this._position,s,t),this._positions[this._position].sprite.setVisible(!1),this._position=s,this._positions[this._position].sprite.setVisible(!0),this._positions[s].actions.death&&t.emit(o.death),this._positions[s].actions.noAction&&(this._autoAction=this._positions[s].actions.noAction,this._timeAutoAction=Date.now())}hit(s){this._wasHit=!0;const t=this._positions[this._position].actions[o.left];t&&this._changePosition(t,s),this._wasHit=!1}move(s,t,e){if(!(this._dead||this._wasHit||this._openCounts>0||this._pause)&&this._positions[this._position].actions[s]){const i=this._positions[this._position].actions[s];if(i.includes("take:"))i.includes("take:key")?this._keyIsTaken||(this._keyIsTaken=!0,t.emit(o.takeKey)):i.includes("take:sword")?this._swordIsTaken||(this._swordIsTaken=!0,t.emit(o.takeSword)):i.includes("take:openKey")&&this._keyIsTaken&&(t.emit(o.openLock),this._openCounts=10);else if("fight:sword"===i)this.swordFight(this._position,e,t);else if(i.includes("cond:")){const s=i.split(":")[1];if("pos25"===s&&"left"===e)return!1;if("pos26"===s&&"middle"===e)return!1;if("pos27"===s&&"right"===e)return!1;this._changePosition(s,t)}else this._autoAction&&(clearTimeout(this._autoAction),this._autoAction=void 0),this._changePosition(i,t)}}isDead(){return this._dead}tick(s){this._dead&&this._flashCountsDead>0&&(this._flashCountsDead--,this._positions[this._position].sprite.setVisible(this._flashCountsDead%2==0),0===this._flashCountsDead&&s.emit(o.deathEnd)),this._openCounts>0&&(this._openCounts--,0===this._openCounts&&(this._keyIsTaken=!1,s.emit(o.openLockFinished))),this._autoAction&&Date.now()-this._timeAutoAction>=800&&this._changePosition(this._autoAction,s)}}class h{hideShow(s){}start(){this.reseting=!1,this.objects.key.sprite.setVisible(!0),this.objects.sword.sprite.setVisible(!0),this.platform2Pos="pos1",this.platform2.pos1.sprite.setVisible(!0),this.platform2.pos2.sprite.setVisible(!1),this.showHideFriendPlatform(!1)}tick(){if(this.reseting)return;this.platform2[this.platform2Pos].sprite.setVisible(!1);const s=this.platform2[this.platform2Pos].actions.noAction;this.platform2Pos=s,this.platform2[s].sprite.setVisible(!0)}takeKey(){this.objects.key.sprite.setVisible(!1)}leaveKey(){this.objects.keyOnLock.sprite.setVisible(!1),this.objects.key.sprite.setVisible(!0)}openLock(){this.objects.keyOnLock.sprite.setVisible(!0)}takeSword(){this.objects.sword.sprite.setVisible(!1)}leaveSword(){this.objects.sword.sprite.setVisible(!0)}showHideFriendPlatform(s){this.friendPlatform.pos1.sprite.setVisible(s)}reset(){this.reseting=!0,this.objects.key.sprite.setVisible(!0),this.objects.sword.sprite.setVisible(!0),this.platform2.pos1.sprite.setVisible(!0),this.platform2.pos2.sprite.setVisible(!0),this.showHideFriendPlatform(!0)}create(s){this.reseting=!1,this.platform2Pos="pos1",this.snake=s.addOthers({x:220,y:620,frame:2,visible:!0},{}),this.dog=s.addOthers({x:340,y:620,frame:3,visible:!0},{}),this.platform=s.addOthers({x:315,y:535,frame:6,visible:!0},{}),this.platform2={pos1:s.addOthers({x:395,y:535,frame:4,visible:!0},{noAction:"pos2"}),pos2:s.addOthers({x:425,y:555,frame:5},{noAction:"pos1"})},this.friend=s.addOthers({x:550,y:525,frame:7,visible:!0},{}),this.friendPlatform={pos1:s.addOthers({x:520,y:610,frame:8,visible:!1},{}),pos2:s.addOthers({x:510,y:595,frame:9,visible:!0},{})},this.objects={key:s.addOthers({x:170,y:650,frame:0,visible:!0},{}),sword:s.addOthers({x:580,y:380,frame:10,visible:!0},{}),keyOnLock:s.addOthers({x:540,y:110,frame:1,scale:.2},{})},this.skull=s.addOthers({x:48,y:295,frame:16,scale:.3,visible:!0},{})}}class n{hideShow(s){this._allMonkeyPositions.forEach((t=>{this._monkey[t].sprite.setVisible(s)})),this._allMonkeyArmPositions.forEach((t=>{this._monkeyArm[t].sprite.setVisible(s)})),this._allBallPositions.forEach((t=>{this._ball[t].sprite.setVisible(s)})),this._allBirdPositions.forEach((t=>{this._bird[t].sprite.setVisible(s)}))}start(){this._changingFloor=!1,this._heroFloor=o.floor1,this._reseting=!1,this._pause=!1,this.hideShow(!1),this._birdPos="pos1",this._bird.pos1.sprite.setVisible(!0),this._middleBallPos=void 0,this._leftBallPos=void 0,this._flashCountsDead=0,this._dead=!1,console.log("Detecting monkey   ....  [MONKEY]"),console.log("Detecting bird     ....  [BIRD]")}reset(){this._changingFloor=!1,this.hideShow(!0),this._reseting=!0,this._monkeyFsmPosStr="left"}moveBird(s,t){this._bird[this._birdPos].sprite.setVisible(!1);const e=this._bird[this._birdPos].actions.noAction;e?(this._birdPos=e,this._bird[e].sprite.setVisible(!0)):console.log("New position empty",this._bird[this._birdPos].actions)}_moveMonkeySprite(s,t){if(this._monkey[s.position].sprite.setVisible(!1),s.arm&&this._monkeyArm[s.arm].sprite.setVisible(!1),t&&(this._monkey[t.position].sprite.setVisible(!0),t.arm&&this._monkeyArm[t.arm].sprite.setVisible(!0),t.drop&&this._heroFloor!==o.floor3)){const s=this._heroFloor===o.floor1?{left:"hBtopScreenFallsLeft",middle:"hBtopScreenFallsMiddle1"}:{left:"hTtopScreenFallsLeft",middle:"hTtopScreenFallsMiddle1"};"left"!==t.position||this._leftBallPos?"middle"!==t.position||this._middleBallPos||(this._middleBallPos=s[t.position],this._ball[this._middleBallPos].sprite.setVisible(!0)):(this._leftBallPos=s[t.position],this._ball[this._leftBallPos].sprite.setVisible(!0))}}death(){this._flashCountsDead=32,this._dead=!0}deathEnd(s,t){this._dead=!1,"pos27"===t&&(console.warn("hero is already there, hero death"),s.emit(o.heroHitByMonkey))}swordHit(){if(!["leftPunch2","middlePunch2","rightPunch2"].includes(this._monkeyFsmFightStr)&&(this._hits>0&&this._hits--,this._hits<=0)){const s=this._monkeyFightFsm2[this._monkeyFsmFightStr];this._allMonkeyArmPositions.forEach((s=>{this._monkeyArm[s].sprite.setVisible(!1)})),"left"===this._monkeyPos?(this._hits=9,this._monkeyFsmFightStr=s.hits,this._monkeyPos="middle"):"middle"===this._monkeyPos?(this._hits=9,this._monkeyFsmFightStr=s.hits,this._monkeyPos="right"):"right"===this._monkeyPos&&(this._monkeyPos="rightDead",this.death());const t=this._monkeyFightFsm2[this._monkeyFsmFightStr];this._moveMonkeySprite(s,t)}}moveMonkey(s,t){if(this._heroFloor===o.floor3){const e=this._monkeyFightFsm2[this._monkeyFsmFightStr];if(this._dead)return;const i=e.noAction,r=Math.random();this._monkeyFsmFightStr=r>.95?i[0]:i[1];const h=this._monkeyFightFsm2[this._monkeyFsmFightStr];this._monkeyPos=h.position,"left"===e.position&&"leftPunch"===e.arm&&"pos24"===t?(this._hits=9,s.emit(o.heroHitByMonkey)):("middle"===e.position&&"middlePunch"===e.arm&&"pos25"===t||"right"===e.position&&"rightPunch"===e.arm&&"pos26"===t)&&(this._hits=9,s.emit(o.heroHitByMonkeyOnMiddleOrRight)),this._moveMonkeySprite(e,h)}else{const s=this._monkeyFsm2[this._monkeyFsmPosStr],t=s.noAction;this._monkeyFsmPosStr=t.length<2?t[0]:t[Math.floor(Math.random()*t.length)];const e=this._monkeyFsm2[this._monkeyFsmPosStr];this._monkeyPos=e.position,this._moveMonkeySprite(s,e)}}getMonkeyPos(){return this._monkeyPos}_moveBallTo(s,t,e){if(e){const s=this._ball[e];if(!s)return void console.warn("no actualNode found for ",e);s.sprite.setVisible(!1);const i=s.actions.noAction,o=i.length<2||!["pos17","pos18","pos19","pos20","pos21"].includes(t)?i[0]:i[1];if(o){if(!this._ball[o])return void console.warn("no automatic node found",e);this._ball[o].sprite.setVisible(!0)}return o}return e}moveBall(s,t){this._middleBallPos=this._moveBallTo(s,t,this._middleBallPos),this._leftBallPos=this._moveBallTo(s,t,this._leftBallPos)}checkBallDeaths(s,t){return this._middleBallPos&&this._ball[this._middleBallPos]&&this._ball[this._middleBallPos].actions.death&&this._ball[this._middleBallPos].actions.death.includes(t)?(s.emit(o.death),!0):!!(this._leftBallPos&&this._ball[this._leftBallPos]&&this._ball[this._leftBallPos].actions.death&&this._ball[this._leftBallPos].actions.death.includes(t))&&(console.warn("Hero death left!!",this._leftBallPos,t),s.emit(o.death),!0)}checkBirdDeaths(s,t){return!!(this._birdPos&&this._bird[this._birdPos]&&this._bird[this._birdPos].actions.death&&this._bird[this._birdPos].actions.death.includes(t))&&(console.warn("Hero death by bird!!",this._birdPos,t),s.emit(o.death),!0)}fastTick(s,t){if(this._dead&&this._flashCountsDead>0){this._flashCountsDead--;const e=this._monkeyFightFsm2[this._monkeyFsmFightStr];this._monkey[e.position].sprite.setVisible(this._flashCountsDead%2==0),0===this._flashCountsDead&&this.deathEnd(s,t)}}tick(s,t){this._reseting||this._pause||this.checkBallDeaths(s,t)||this.checkBirdDeaths(s,t)||(this.moveBird(s,t),this.moveMonkey(s,t),this.moveBall(s,t))}changeFloor(s,t){if(this._heroFloor=s,this._flashCountsDead=0,this._dead=!1,s===o.floor3){const s=this._monkeyFsm2[this._monkeyFsmPosStr];this._monkeyPos="left",this._monkeyFsmPosStr="left",this._monkeyFsmFightStr="left",this._hits=9;const t=this._monkeyFightFsm2[this._monkeyFsmFightStr];this._moveMonkeySprite(s,t)}else if(s===o.floor2&&t===o.down){const s=this._monkeyFightFsm2[this._monkeyFsmFightStr];this._monkeyFsmFightStr="",this._monkeyPos="left",this._monkeyFsmPosStr="left";const t=this._monkeyFsm2[this._monkeyFsmPosStr];this._moveMonkeySprite(s,t)}}paws(){this._pause=!0}unPaws(){this._pause=!1}create(s){this._reseting=!1,this._hits=9,this._heroFloor=o.floor1,this._monkeyPos="",this._monkeyFsmPosStr="left",this._monkeyFsmFightStr="",this._middleBallPos=void 0,this._leftBallPos=void 0,this._birdPos="pos1",this._pause=!1,this._bird={pos1:s.addOthers({x:430,y:365,frame:11},{noAction:"pos2"}),pos2:s.addOthers({x:350,y:380,frame:12},{noAction:"pos3",death:["pos10"]}),pos3:s.addOthers({x:310,y:400,frame:13},{noAction:"pos4",death:["pos9"]}),pos4:s.addOthers({x:210,y:380,frame:14},{noAction:"pos5",death:["pos6"]}),pos5:s.addOthers({x:100,y:380,frame:15},{noAction:"pos1"})},this._monkeyFightFsm2={left:{position:"left",arm:"leftDrop",drop:!1,noAction:["left","leftPunch1"],hits:"middle"},leftPunch1:{position:"left",arm:"leftTake",drop:!1,noAction:["leftPunch2","leftPunch2"],hits:"middle"},leftPunch2:{position:"left",arm:"leftPunch",drop:!1,noAction:["left","left"],hits:"middle"},middle:{position:"middle",arm:"middleDrop",drop:!1,noAction:["middle","middlePunch1"],hits:"right"},middlePunch1:{position:"middle",arm:"middleTake",drop:!1,noAction:["middlePunch2","middlePunch2"],hits:"right"},middlePunch2:{position:"middle",arm:"middlePunch",drop:!1,noAction:["left","left"],hits:"right"},right:{position:"right",arm:"",drop:!1,noAction:["right","rightAngry","rightPunch1"],hits:"killed"},rightPunch1:{position:"right",arm:"rightTake",drop:!1,noAction:["rightPunch2","rightPunch2"],hits:"killed"},rightPunch2:{position:"right",arm:"rightPunch",drop:!1,noAction:["middle","middle"],hits:"killed"},rightAngry:{position:"right",arm:"rightAngry",drop:!1,noAction:["right","right"]}},this._monkeyFsm2={left:{position:"left",arm:"leftDrop",drop:!1,noAction:["middleTakeDrop1","leftTakeDrop1"]},right:{position:"right",arm:"",drop:!1,noAction:["right","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","rightAngry"]},middle:{position:"middle",arm:"middleDrop",drop:!1,noAction:["right","left","middle","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1","middleTakeDrop1"]},leftTakeDrop1:{position:"left",arm:"leftTake",drop:!1,noAction:["leftTakeDrop2"]},leftTakeDrop2:{position:"left",arm:"leftDrop",drop:!0,noAction:["left","middleTakeDrop1","middleTakeDrop1","middle"]},middleTakeDrop1:{position:"middle",arm:"middleTake",drop:!1,noAction:["middleTakeDrop2"]},middleTakeDrop2:{position:"middle",arm:"middleDrop",drop:!0,noAction:["right","left"]},rightAngry:{position:"right",arm:"rightAngry",drop:!1,noAction:["middle"]}},this._monkey={left:s.addOthers({x:110,y:130,frame:20},{}),middle:s.addOthers({x:265,y:100,frame:21},{}),right:s.addOthers({x:420,y:55,frame:22},{})},this._monkeyArm={leftTake:s.addOthers({x:160,y:135,frame:34},{}),leftDrop:s.addOthers({x:184,y:175,frame:33},{}),leftPunch:s.addOthers({x:105,y:150,frame:35},{}),middlePunch:s.addOthers({x:250,y:125,frame:35},{}),middleDrop:s.addOthers({x:322,y:145,frame:33},{}),middleTake:s.addOthers({x:300,y:110,frame:34},{}),rightPunch:s.addOthers({x:435,y:100,frame:42,scale:.3},{noAction:"right_1"}),rightAngry:s.addOthers({x:465,y:70,frame:41,scale:.3},{noAction:"right_2"}),rightTake:s.addOthers({x:470,y:82,frame:43,scale:.3},{noAction:"right"})},this._ball={hBtopScreenFallsMiddle1:s.addOthers({x:285,y:230,frame:39},{noAction:["hBtopScreenFallsMiddle2"]}),hBtopScreenFallsMiddle2:s.addOthers({x:285,y:280,frame:37},{noAction:["hBdownScreenTop"]}),hBdownScreenTop:s.addOthers({x:190,y:380,frame:37},{noAction:["hBdownScreenMiddle"]}),hBdownScreenMiddle:s.addOthers({x:170,y:480,frame:37},{noAction:["hBdownScreenCloseToKey"],death:["pos4"]}),hBdownScreenCloseToKey:s.addOthers({x:120,y:610,frame:37},{noAction:[""],death:["pos2"]}),hBtopScreenFallsLeft:s.addOthers({x:170,y:250,frame:39},{noAction:["hBtopScreenFallsLeftFloor"]}),hBtopScreenFallsLeftFloor:s.addOthers({x:145,y:320,frame:37},{noAction:["hBtopScreenOverSkull"]}),hBtopScreenOverSkull:s.addOthers({x:45,y:260,frame:39},{noAction:[""]}),hTtopScreenRight3:s.addOthers({x:580,y:340,frame:37},{noAction:[""]}),hTtopScreenRight2:s.addOthers({x:480,y:340,frame:37},{noAction:["hTtopScreenRight3"],death:["pos17"]}),hTtopScreenRight1:s.addOthers({x:385,y:330,frame:37},{noAction:["hTtopScreenRight2"],death:["pos19"]}),hTtopScreenRight0:s.addOthers({x:290,y:320,frame:39},{noAction:["hTtopScreenLeft1","hTtopScreenRight1"],death:["pos21"]}),hTtopScreenFallsMiddle1:s.addOthers({x:285,y:230,frame:39},{noAction:["hTtopScreenFallsMiddle2"]}),hTtopScreenFallsMiddle2:s.addOthers({x:285,y:280,frame:37},{noAction:["hTtopScreenRight0"]}),hTtopScreenLeft1:s.addOthers({x:255,y:310,frame:37},{noAction:["hTtopScreenLeft2"],death:["pos22"]}),hTtopScreenLeft2:s.addOthers({x:145,y:320,frame:37},{noAction:["hTtopScreenOverSkull"],death:["pos23"]}),hTtopScreenFallsLeft:s.addOthers({x:170,y:250,frame:39},{noAction:["hTtopScreenLeft2"]}),hTtopScreenOverSkull:s.addOthers({x:45,y:260,frame:39},{noAction:[""]})},this._allMonkeyPositions=Object.keys(this._monkey),this._allMonkeyArmPositions=Object.keys(this._monkeyArm),this._allBallPositions=Object.keys(this._ball),this._allBirdPositions=Object.keys(this._bird)}}class a{unlock(){this._locksStatus--,this._locksStatus}hideShow(s){this._allPositions.forEach((t=>{this._positions[t].sprite.setVisible(s)})),this._allLocks.forEach((t=>{this._locks[t].sprite.setVisible(s)}))}start(){this.hideShow(!1),this._locksStatus=4,this._positions.pos1.sprite.setVisible(!0),this._allLocks.forEach((s=>{this._locks[s].sprite.setVisible(!0)})),console.log("Detecting princess ....  [PRINCE]")}reset(){this.hideShow(!0)}openLock(s){this._locksStatus>0&&this._locksStatus--,3===this._locksStatus?this._locks.lock1.sprite.setVisible(!1):2===this._locksStatus?this._locks.lock3.sprite.setVisible(!1):1===this._locksStatus?this._locks.lock2.sprite.setVisible(!1):0===this._locksStatus&&(this._locks.lock4.sprite.setVisible(!1),this._positions.pos1.sprite.setVisible(!1),this._positions.pos2.sprite.setVisible(!0),s.emit(o.princessFree))}getLocksCount(){return this._locksStatus}create(s){this._locksStatus=4,this._positions={pos1:s.addOthers({x:540,y:65,frame:18,scale:.3,visible:!0},{}),pos2:s.addOthers({x:557,y:115,frame:19,scale:.25},{})},this._locks={lock1:s.addOthers({x:530,y:70,frame:17,visible:!0},{}),lock2:s.addOthers({x:610,y:65,frame:17,visible:!0},{}),lock3:s.addOthers({x:535,y:105,frame:17,visible:!0},{}),lock4:s.addOthers({x:610,y:95,frame:17,visible:!0},{})},this._allPositions=Object.keys(this._positions),this._allLocks=Object.keys(this._locks)}}const d=document.getElementById("game-canvas"),l={type:t.WEB_GL,height:880,width:600,canvas:d,fps:{target:10,forceSetTimeOut:!0},physics:{default:"arcade",arcade:{gravity:{y:400},debug:!1}},scene:[e,class extends i{constructor(){super("scene-game")}create(){this.events.on(o.takeKey,this.keyHandler,this),this.events.on(o.takeSword,this.swordHandler,this),this.events.on(o.friendPlatform,this.inPlatform,this),this.events.on(o.friendPlatformLeave,this.outPlatform,this),this.events.on(o.death,this.deathStarts,this),this.events.on(o.deathEnd,this.deathEnds,this),this.events.on(o.noLives,this.noLives,this),this.events.on(o.floor3,this.heroFloor3,this),this.events.on(o.floor2,this.heroFloor2,this),this.events.on(o.floor1,this.heroFloor1,this),this.events.on(o.swordHit,this.swordHit,this),this.events.on(o.heroHitByMonkey,this.heroHitByMonkey,this),this.events.on(o.heroHitByMonkeyOnMiddleOrRight,this.heroHitByMonkeyOnMiddleOrRight,this),this.events.on(o.openLock,this.openLock,this),this.events.on(o.openLockFinished,this.openLockFinished,this),this.events.on(o.princessFree,this.princessFree,this),this.triggerTimer=this.time.addEvent({callback:this.fastTicker,callbackScope:this,delay:250,loop:!0}),this.normalTimer=this.time.addEvent({callback:this.ticker,callbackScope:this,delay:1e3,loop:!0}),this.reseting=!1,this.reseted=!1,this.cameras.main.setBackgroundColor(16777215),this.add.image(300,500,"bottom"),this.add.image(300,160,"top"),this.add.image(300,780,"buttons");const s=this.add.image(463,742,"up"),t=this.add.image(463,825,"down"),e=this.add.image(405,782,"left"),i=this.add.image(520,776,"right"),d=this.add.image(250,760,"start"),l=this.add.image(85,788,"jump");s.setName("up"),t.setName("down"),e.setName("left"),i.setName("right"),d.setName("start"),l.setName("jump"),s.setInteractive(),t.setInteractive(),e.setInteractive(),i.setInteractive(),d.setInteractive(),l.setInteractive();const p=(c=this.physics,{addHeroTo:({x:s,y:t,frame:e},{left:i,right:o,up:r,down:h,jump:n,noAction:a,death:d})=>{const l=c.add.sprite(s,t,"hero");return l.body.setAllowGravity(!1),l.body.reset(s,t+0),l.setFrame(e),l.setVisible(!1),l.setScale(.25),{sprite:l,actions:{left:i,right:o,up:r,down:h,jump:n,noAction:a,death:d}}},addOthers:({x:s,y:t,frame:e,scale:i=.25,visible:o=!1,rotate:r=0},{left:h,right:n,up:a,down:d,jump:l,noAction:p,death:m})=>{const f=c.add.sprite(s,t,"others");return f.body.setAllowGravity(!1),f.body.reset(s,t+0),f.setFrame(e),f.setVisible(o),f.setScale(i),f.setRotation(r),{sprite:f,actions:{left:h,right:n,up:a,down:d,jump:l,noAction:p,death:m}}}});var c;this.hero=new r,this.hero.create(p),this.enemies=new n,this.enemies.create(p),this.statics=new h,this.statics.create(p),this.princess=new a,this.princess.create(p),this.hero.start(),this.statics.start(),this.base_create(),this.cursors=this.input.keyboard.createCursorKeys(),this.enterKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER),this.takeKeySound=this.sound.add("takeKey"),this.takeSwordSound=this.sound.add("takeSword"),this.deathSound=this.sound.add("death"),this.keyPressSound=this.sound.add("keyPress"),this.input.on("pointerup",((s,t)=>{const{worldX:e,worldY:i}=s;if(console.warn(e,i),t.length){const s=t[0].name;this.keyPressSound.play();const e={up:o.up,down:o.down,left:o.left,right:o.right,jump:o.jump}[s];e?this.hero.move(e,this.events,this.enemies.getMonkeyPos()):"start"===s&&(this.reseting=!0)}}))}ticker(){this.hero.isDead()||(this.statics.tick(this.events),this.enemies.tick(this.events,this.hero.getPosition()))}fastTicker(){this.hero.tick(this.events),this.enemies.fastTick(this.events,this.hero.getPosition())}keyHandler(){this.takeKeySound.play(),this.statics.takeKey()}swordHandler(){this.takeSwordSound.play(),this.statics.takeSword()}inPlatform(){this.statics.showHideFriendPlatform(!0)}outPlatform(){this.statics.showHideFriendPlatform(!1)}princessFree(){console.warn("Game won!!!"),this.enemies.paws(),this.takeSwordSound.play()}princessFreeEnds(){console.warn("===== Princess free ends ==== "),this.hero.tryAgain(this.events,!0),this.statics.start(),this.princess.reset(),this.princess.start(),this.enemies.start()}deathStarts(){this.hero.death(),this.enemies.paws(),this.deathSound.play()}deathEnds(){this.statics.start(),this.enemies.start(),this.hero.tryAgain(this.events)}noLives(){console.warn("No more lives")}heroFloor3(s){this.enemies.changeFloor(o.floor3,s)}heroFloor2(s){this.enemies.changeFloor(o.floor2,s)}heroFloor1(s){this.statics.leaveSword(),this.enemies.changeFloor(o.floor1,s)}swordHit(){this.enemies.swordHit()}openLock(){console.warn("Opening lock..."),this.statics.openLock(),this.princess.openLock(this.events),this.takeKeySound.play()}openLockFinished(){this.statics.leaveKey(),0===this.princess.getLocksCount()&&this.princessFreeEnds()}heroHitByMonkey(){this.deathStarts()}heroHitByMonkeyOnMiddleOrRight(){this.hero.hit(this.events)}update(s,t){super.update(s,t),(this.cursors.down.isDown||this.cursors.up.isDown||this.cursors.left.isDown||this.cursors.right.isDown)&&this.keyPressSound.play(),this.cursors.shift.isDown&&(this.reseting=!0),this.reseting&&this.cursors.shift.isUp&&(this.reseting=!1,console.log("Tandy Hero and Princess BIOS"),console.log(""),console.log("Main Processor: Sharp SM5XX"),console.log("Chipsel Model: None"),console.log(""),this.reseted||(this.hero.reset(),this.enemies.reset(),this.statics.reset(),this.princess.reset(),this.reseted=!0,this.time.addEvent({callback:()=>{this.hero.start(),this.princess.start(),this.enemies.start(),this.statics.start(),this.reseted=!1,console.log(""),console.log("Booting... ")},callbackScope:this,delay:2e3,loop:!1})));const e=this.keysToAction();e&&!this.reseted&&this.hero.move(e,this.events,this.enemies.getMonkeyPos())}keysToAction(){return this.cursors.right.isDown?o.right:this.cursors.left.isDown?o.left:this.cursors.up.isDown?o.up:this.cursors.down.isDown?o.down:this.cursors.space.isDown?o.jump:void 0}_checkTarget(){}}]};new s.Game(l);
